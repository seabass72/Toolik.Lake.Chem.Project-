---
header-includes: #allows you to add in your own Latex packages
- \usepackage{float} #use the 'float' package
- \floatplacement{figure}{H} #make every figure with caption = h
output: 
  pdf_document:
    keep_tex: yes
    fig_caption: yes
    number_sections: yes
geometry: margin=2.54cm
title: Experiment Title
subtitle: "https://github.com/seabass72/Toolik.Lake.Chem.Project-"
author: "Sebastian Bognar"
abstract: "Experimental overview. This section should be no longer than 250 words."
fontsize: 12pt
mainfont: Times New Roman
---

<Information in these brackets are used for annotating the RMarkdown file. They will not appear in the final version of the PDF document>

\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

<Setup the global options for the R chunks in your document>

<Note: set up autoreferencing for figures and tables in your document>

```{r setup, include=FALSE}
# Set your working directory
setwd("/Users/Seabass/Documents/Duke/spring_2019/env_872L/lesson_2/Toolik.Lake.Chem.Project")

# Load your packages
library(tidyverse)
library(ggplot2)
library(lubridate)
library(nlme)
library(lsmeans)
library(multcompView)
library(naniar)
library(chron)
library(reshape2)
library(ggpubr)
library(FSA)
library(corrplot)
library(trend)
library(gridExtra)
library(ggsignif)
library(knitr)
library(bookdown)

# Set your ggplot theme

theme_Final_Project <- theme_classic(base_size = 12) +
  theme(axis.text = element_text(color = "black"), 
        legend.position = "right", 
        axis.ticks = element_line(colour = "black"),
        panel.border = element_rect(fill= NA,color="black", size=0.5, 
                                    linetype="solid"),
        panel.grid.major.y =element_line(color = "grey"),
        panel.grid.minor.y = element_blank(),
        panel.grid.major.x  = element_blank(),
        panel.grid.minor.x  = element_blank(),
        axis.text.x = element_text(angle = 0,  hjust = 1),
        panel.background = element_rect(fill = "#bdbdbd", 
                                          size = 2, linetype = "solid"),
        panel.grid.major = element_line(size = 0.5, linetype = 'solid',
                                        colour = "white") )


```


# Research Question and Rationale

<Paragraph detailing the rationale for your analysis. What is the significant application and/or interest in this topic? Connect to environmental topic(s)/challenge(s).>

<Paragraph detailing your research question(s) and goals. What do you want to find out? Include a sentence (or a few) on the dataset you are using to answer this question - just enough to give your reader an idea of where you are going with the analysis.>

The first objective of the study was to understand if there were significant differences in the physical and chemical water quality characteristics between the five major lakes near the Toolik Field Station (E5, Fog 2, I7, I5, & Toolik Lakes). The next objective was to determine if there were any water quality parameters that were significant predictors of chlorophyll a concentrations in all the lakes in the study area (74 lakes). Finally, I wanted to see if there were any monotonic trends present within the distribution of chlorophyll a, dissolved oxygen, pH, water temperature, PAR, and conductivity for Toolik Lake. To answer these questions, I looked at chemical and physical water quality data for lakes near the Toolik Field Station. The dataset was collected during the summers from 2010-2014 and measured water quality data at a total of 74 lakes.

\newpage

# Dataset Information

<Information on how the dataset for this analysis were collected, the data contained in the dataset, and any important pieces of information that are relevant to your analyses. This section should contain much of same information as the README file for the dataset but formatted in a way that is more narrative.>

The dataset included the physical and chemical water quality measurements for various lakes that were located near the Toolik Lake Research Station in Alaska for the years: 2010-2014 (Table \ref{tab:table}). The data was collected as part of the Long Term Ecological Research (LTER) for the National Science Foundation (NSF). The water quality parameters that I used for my study were chlorophyll a concentration, dissolved oxygen concentration, pH, water temperature, photosynthetically active radiation, depth of measurement, secchi depth, and conductivity. The site descriptors for the dataset included site name, time, date, and depth. For the first objective of my analysis, I focused on five lakes that had the most observations: Toolik, E5, I7, I5, and Fog 2 Lake. Lake E5 also has undergone nutrient enrichment and the other four lakes are classified as reference lakes. 

To collect water quality data, A hydrolab Surveyor 4 data logger and Datsonde DS5 multiprobe were used to measure: depth (m), pH, specific conductivity (uS/cm), dissolved oxygen (mg/L), water temperature (Celsius), in-vivo fluorescence(chlorophyll a concentration), and photosynthetic active radiation (PAR) at half meter to meter intervals depending on the depth of the lake. To determine the secchi depth, A secchi disk (22 cm black and white disk) was used. There was only one depth for each site that was taken on a particular day for secchi depth. The data was only collected from June to August due to the lakes usually being frozen over for most of the year. 



```{r table,  echo = FALSE}




Names <-c("Site", "Date", "Depth_m", "Time_hr", "Temp_C", "Cond_uS", "pH", "Dissolved_Oxygen", "Chla_ug", "PAR", "Secchi_Depth")

Units <- c("Name", "YYYY-MM-DD","Meters","HH:MM", "Celsius", "uS/cm", "-log[H+]", "mg/L","ug/L","uE/m2/sec","Meters" )

Data_Structure <- c("Character", "Date", "Numeric","Character","Numeric","Numeric","Numeric","Numeric","Numeric","Numeric","Numeric")

data_ARC<- data.frame(Names, Units,  Data_Structure)

colnames(data_ARC)<- (c("Measurement", "Units",  "Data Structure"))

kable(data_ARC,caption="\\label{tab:table}Artic Lakes Data Summary")
```



<Add a table that summarizes your data structure. This table can be made in markdown text or inserted as a `kable` function in an R chunk. If the latter, do not include the code used to generate your table.>

\newpage

# Exploratory Data Analysis and Wrangling

## Summary Statistics for the Dataset

1. The dimensions of the dataset were 6239 rows and 20 columns. I wanted to understand the dimensions of the dataset so that I could understand how large of dataset was.


```{r}

# import the raw dataset 

ARC.PhysChem.2010_14.Raw <- read.csv(
  "./Data/RAW/ARC_Lakes_Physchem_2010-2014.csv")


# 1 dimensions of the dataset

dim(ARC.PhysChem.2010_14.Raw)

```

2. The column names of the dataset are presented below. I wanted to understand the chemical and physical water quality parameters that were present in the dataset with the colnames function.


```{r}
# 2 column names in the proceesed Toolik dataset

colnames(ARC.PhysChem.2010_14.Raw)
```


3. With the str function, I wanted to understand the structure and format of all the of the variables in the dataset.  


```{r}
# 3 determine the structure of the dataset

str(ARC.PhysChem.2010_14.Raw)
```


4. With the head function, I wanted to see how the dataset was organized and what measurements looked like in the dataset.


```{r}
# 4 the first 5 rows of the dataset 

head(ARC.PhysChem.2010_14.Raw)

```


5. I used the summary function, to see the distribution of the samples all of the variables in the dataset to get a better understanding of chemical and physical water quality parameters in the arctic region of Alaska. 


```{r}
# 5 look at the summary for each of the columns present in the dataset

summary(ARC.PhysChem.2010_14.Raw)
```

## Data Wrangling

1. The dataset had columns that I did not need for analysis, so used a pipe function to select the columns that I needed for my analysis.


```{r}

# 1 remove unnessary columns 

ARC.PhysChem.selectedcolumns.Raw <- ARC.PhysChem.2010_14.Raw %>%
  select("Site", "Date", "Rounded.Depth..m.", "Time_hr_dst","Temp_C",
         "Cond_uS", "pH","DO_mg.l","Chl_ug.l" , "PAR_uEm2s", "Secchi_m" ) 
  
```


2. The colnames were a bit long and I renamed the columns to make analysis more efficient.


```{r}
# 2 rename the columns with simpler names 
  
colnames(ARC.PhysChem.selectedcolumns.Raw) <- c("Site", "Date", "Depth_m", "Time_hr",
                                                "Temp_C", "Cond_uS", "pH","Dissolved_Oxygen","Chla_ug", "PAR", 
                                                "Secchi_Depth"  )
```


3. Areas with missing values would impede workflow and hinder my analyis, so missing values had to be removed. Values that were missing were labeled as periods and were hard to remove as periods. I converted the periods into NAs that could be easily removed from the dataset. I used the drop_na function remove the NAs from the dataset.


```{r}
# 3 make periods (missing values into NAs)
  
  ARC.PhysChem.selectedcolumns.Raw[ ARC.PhysChem.selectedcolumns.Raw == "." ] <- NA
  ARC.PhysChem.selectedcolumns.Raw[ ARC.PhysChem.selectedcolumns.Raw == "" ] <- NA
  
# remove the nas from the dataset
  
ARC.PhysChem.2010_2014.cleaned <- drop_na(ARC.PhysChem.selectedcolumns.Raw)
```


4. Many of the measurements were in the factor format, which were creating issues with many of the statistical models. I converted the measurements that were numeric into the numeric format and the ones that were characters into the character format.


```{r}
# 4 change columns that are numbers that are miss cateloged as
#factors with as.numeric and as.character

ARC.PhysChem.2010_2014.cleaned$Depth_m <- as.numeric(
  as.character(ARC.PhysChem.2010_2014.cleaned$Depth_m))

ARC.PhysChem.2010_2014.cleaned$Temp_C <- as.numeric(
  as.character(ARC.PhysChem.2010_2014.cleaned$Temp_C))

ARC.PhysChem.2010_2014.cleaned$Cond_uS <- as.numeric(
  as.character(ARC.PhysChem.2010_2014.cleaned$Cond_uS))

ARC.PhysChem.2010_2014.cleaned$pH <- as.numeric(
  as.character(ARC.PhysChem.2010_2014.cleaned$pH))

ARC.PhysChem.2010_2014.cleaned$Dissolved_Oxygen <- as.numeric(
  as.character(ARC.PhysChem.2010_2014.cleaned$Dissolved_Oxygen))

ARC.PhysChem.2010_2014.cleaned$Chla_ug <- as.numeric(
  as.character(ARC.PhysChem.2010_2014.cleaned$Chla_ug))

ARC.PhysChem.2010_2014.cleaned$PAR <- as.numeric(
  as.character(ARC.PhysChem.2010_2014.cleaned$PAR))

ARC.PhysChem.2010_2014.cleaned$Secchi_Depth <- as.character(
  ARC.PhysChem.2010_2014.cleaned$Secchi_Depth)

ARC.PhysChem.2010_2014.cleaned$Time_hr <- as.character(
  ARC.PhysChem.2010_2014.cleaned$Time_hr)

ARC.PhysChem.2010_2014.cleaned$Site <-as.character(
  ARC.PhysChem.2010_2014.cleaned$Site)


```

5. The date format was also in the factor format as well. if I wanted to graph or do further analysis, I would need the date in the date format. I used as.Date to convert the date into the date format.

```{r}
# 5 make sure that date column is in the date format 

ARC.PhysChem.2010_2014.cleaned$Date <- as.Date(
  ARC.PhysChem.2010_2014.cleaned$Date, "%d-%B-%y")



```


6. The secchi depth had characters (>Xm) inputted in with the measurements where the secchi disk hit bottom before the secchi depth was recorded. To fix this issue, I changed the values to "-1" and converted the format of the secchi depth to numeric. I saved the processed dataset in the Processed data folder.


```{r}
# 6 make secchi depths where hit bottom a number instead of a character (-1)

ARC.PhysChem.2010_2014.cleaned$Secchi_Depth[
  ARC.PhysChem.2010_2014.cleaned$Secchi_Depth == ">Xm"] <- -1

ARC.PhysChem.2010_2014.cleaned$Secchi_Depth <- as.numeric(
  ARC.PhysChem.2010_2014.cleaned$Secchi_Depth)

#  Save the processed dataset

write.csv(ARC.PhysChem.2010_2014.cleaned,
          file = "./Data/Processed/ARC.PhysChem.2010_2014.Processed.csv",row.names = FALSE)

```



## Data Exploration 

### Chlorophyll a Concentration vs. Depth Plot for the 5 Major Lakes near the Toolik Field Station


```{r fig1, echo=FALSE, fig.cap ="\\label{fig:fig1}The plot above shows the chlorophyll a concentrations(ug/L) vs. Depth (m) for five of the major lakes in the region.", fig.width=10, fig.height=6, fig.pos='H' }

# working with the cleaned dataset

ARC.PhysChem.2010_2014.processed<- ARC.PhysChem.2010_2014.cleaned

# 1 Plot to see Chlorophyll A concentration vs. Depth 

#filter for lakes with the most observations (top 5)

ARC.PhysChem.5_major_Lakes.processed <- ARC.PhysChem.2010_2014.processed %>%
  filter(Site == "Toolik"| Site == "E5" | Site == "Fog 2"|  Site == "I7"|  Site == "I5")



CHLA_DEPTH_PLOT <-  ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Chla_ug, y= Depth_m, color = Site)) +
  geom_point()+
  theme_Final_Project+
  scale_y_reverse( lim=c(20,0))+
  scale_colour_manual(values = c('#fed976','#feb24c','#fd8d3c','#f03b20','#bd0026'))+
  ylab("Depth (m)")+
  xlab(expression("Chlorophyll a Concentration"~"("*mu*g/L*")"))+
  ggtitle(" Chlorophyll a Concentrations vs. Depth for Lakes near the Toolik Field Station")+
  theme(plot.title = element_text(hjust = 0.5))+
  labs(color='Lake Name')

 CHLA_DEPTH_PLOT
```


The Chlorophyll a Concentration vs. Depth Plot diplays that chlorophyll a concentrations appear to be the highest upper water column(figure \ref{fig:fig1}). Additionally, it appears that Lake E5 has the highest concentration of chlorophyll a. Chlorophyll a appear to be present throughout the water column, even at deeper depths. Finally, it appears that Toolik and I7 Lake are the deepest lakes out of the five.

### Chlorophyll a Concentration vs. Time Plot for the 5 Major Lakes near the Toolik Field Station

The Chlorophyll a Concentration vs. Time Plot for the 5 Major Lakes near the Toolik Field Station appears to be showing an increasing trend from 2010 to 2014 (figure \ref{fig:fig2}). The Chlorophyll a concentrations seem to be highest in the early summer and decrease in the later summer months. Temperature and sunlight could be a likely cause of the decrease in the latter part of summer due to the fact that the lakes are located at higher latitudes. 

```{r fig2, echo=FALSE, fig.cap ="\\label{fig:fig2}The plot above shows the chlorophyll a concentrations(ug/L) vs. Time for five of the major lakes in the region.", fig.width=10, fig.height=6, fig.pos='H' }

 # 2 plot to see how chlorophyll a changes over Time (2010-2014)
 
 CHLA_Time_PLOT <-  ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Date, y= Chla_ug, color = Site)) +
   geom_point()+
   theme_Final_Project+
   scale_colour_manual(values = c('#d73027','#fc8d59','#fee08b','#d9ef8b','#91cf60'))+
   xlab("Date")+
   ylab(expression("Chloropyll a Concentration"~"("*mu*g/L*")"))+
   ggtitle(" Chlorophyll a Concentrations vs. Time for Lakes near the Toolik Field Station")+
   theme(plot.title = element_text(hjust = 0.5))+
   labs(color='Lake Name')+
   scale_x_date(date_breaks = "2 month", date_labels = "%m/%Y")+
   theme(axis.text.x = element_text(angle = 45,  hjust = 1))
 
 CHLA_Time_PLOT
 
 
```


### Physical and Chemical Water Quality Parameters Plot for Lakes near the Toolik Field Station

Physical and Chemical Water Quality Parameters plot show the distribution of Chlorophyll a, dissolved oxygen, pH, conductivity, water temperature, and photosynthetically active radiation (PAR) for the lakes: Toolik, E5, I7, I5, and Fog 2 (figure \ref{fig:fig3}). Lake E5 has the highest chlorophyll a concentration out of the five lakes whereas the other lakes have similar chlorophyll a distributions. There is a pretty even distribution of PAR across the five lakes, which makes sense because they are in the same general geographic location. Lake Fog 2 has the coldest water temperatures compared to the other lakes and the highest conductivity as well. Lake Fog 2 also has the highest dissolved oxygen concentration, which could be attributed to the colder water temperatures.The five lakes have differing pHs and Lake E5 has the lowest pH out of the lakes. 

```{r fig3, echo=FALSE, fig.cap ="\\label{fig:fig3}Physical and Chemical Water Quality Parameters for Lakes near the Toolik Field Station", fig.width=10, fig.height=8, fig.pos='H' }
 # 3 Water quality Measurements accross the five lakes (use gg arrange to make a graph with 5 plots)
 
 
 #  temperature plot
 
 LAKE.v.TEMP.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = Temp_C, fill =Site ))+
   geom_violin()+
   theme_Final_Project+
   ylab(expression("Temperature"*~degree*C))+
   theme(legend.position = "none")+
   scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
   theme(panel.background = element_rect(fill = "white", 
                                   size = 2, linetype = "solid"))+
   theme(panel.grid.major.y =element_blank())+
   theme(text = element_text(size=12))+
   theme(plot.title = element_text(hjust = 0.5))+
   theme(axis.title.x = element_blank())
   
 
 
 # conductivity plot 
 
 
 LAKE.v.COND.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = Cond_uS, fill =Site ))+
   geom_violin()+
   theme_Final_Project+
   ylab("Conductivity (uS/cm)")+
   theme(legend.position = "none")+
   scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
   theme(panel.background = element_rect(fill = "white", 
                                         size = 2, linetype = "solid"))+
   theme(panel.grid.major.y =element_blank())+
   theme(text = element_text(size=12))+
   theme(plot.title = element_text(hjust = 0.5))+
   theme(axis.title.x = element_blank())
 
 
 
 #pH plot
 LAKE.v.pH.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = pH, fill =Site ))+
   geom_violin()+
   theme_Final_Project+
   ylab("pH")+
   theme(legend.position = "none")+
   scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
   theme(panel.background = element_rect(fill = "white", 
                                         size = 2, linetype = "solid"))+
   theme(panel.grid.major.y =element_blank())+
   theme(text = element_text(size=12))+
   theme(plot.title = element_text(hjust = 0.5))+
   theme(axis.title.x = element_blank())
 
 
 
 # dissolved oxygen plot
 
 LAKE.v.DO.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = Dissolved_Oxygen, fill =Site ))+
   geom_violin()+
   theme_Final_Project+
   ylab("DO (mg/L)")+
   theme(legend.position = "none")+
   scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
   theme(panel.background = element_rect(fill = "white", 
                                         size = 2, linetype = "solid"))+
   theme(panel.grid.major.y =element_blank())+
   theme(text = element_text(size=12))+
   theme(plot.title = element_text(hjust = 0.5))+
   theme(axis.title.x = element_blank())
 
 
 
 # chla plot
 
 LAKE.v.chla.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = Chla_ug, fill =Site ))+
   geom_violin()+
   theme_Final_Project+
   ylab(expression("Chla Concentration"~"("*mu*g/L*")"))+
   theme(legend.position = "none")+
   scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
   theme(panel.background = element_rect(fill = "white", 
                                         size = 2, linetype = "solid"))+
   theme(panel.grid.major.y =element_blank())+
   theme(text = element_text(size=12))+
   theme(plot.title = element_text(hjust = 0.5))+
   theme(axis.title.x = element_blank())
 
 
 
 # PAR plot
 
 LAKE.v.PAR.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = PAR, fill =Site ))+
   geom_violin()+
   theme_Final_Project+
   ylab(expression("PAR"~"("*mu*E/m^2/sec*")"))+
   theme(legend.position = "none")+
   scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
   theme(panel.background = element_rect(fill = "white", 
                                         size = 2, linetype = "solid"))+
   theme(panel.grid.major.y =element_blank())+
   theme(text = element_text(size=12))+
   theme(plot.title = element_text(hjust = 0.5))+
   theme(axis.title.x = element_blank())
   
 
 

 # using gg arrange to put all the plots together 
 
 WATER_Q_Total_Plot <- ggarrange(LAKE.v.chla.PLOT,LAKE.v.PAR.PLOT, LAKE.v.TEMP.PLOT, LAKE.v.COND.PLOT, LAKE.v.DO.PLOT, LAKE.v.pH.PLOT,  ncol = 2, nrow = 3)
 WATER_Q_Total_Plot_complete<-annotate_figure(WATER_Q_Total_Plot,
                 top = text_grob("Physical and Chemical Water Quality Parameters for Lakes near the Toolik Field Station ", color = "black", face = "bold", size = 14))

 
 WATER_Q_Total_Plot_complete
 
```



<Include R chunks for 5+ lines of summary code (display code and output), 3+ exploratory graphs (display graphs only), and any wrangling you do to your dataset(s).> 

<Include text sections to accompany these R chunks to explain the reasoning behind your workflow, and the rationale for your approach.>


\newpage

# Analysis

## Statistical Analysis 1: Significant Differences between Lakes

### Separate Data and Check Assumptions 

First, I separated the five lakes into individal datasets, so that I could check the normality and homogeneity of variances. Normality and homogeneity of variances are key assumptions that need to be met if I want to run an ANOVA. I used a Shapiro-Wilks test to test if the data was normality distributed. However, the data was not normally distributed, which is common with water quality data. Similarly, the data did not meet the assumption of homogeneity of variances. 


```{r}
 # 1 separate water quality parameters for each of the five lakes 
 
  #A Toolik Lake
  ARC.PhysChem.Toolik.processed <- ARC.PhysChem.5_major_Lakes.processed %>%
    filter(Site =="Toolik" )
    
  
  #B LAke E5
  
  ARC.PhysChem.E5.processed <- ARC.PhysChem.5_major_Lakes.processed %>%
    filter(Site =="E5")
  
  #C Lake FOG 2
  
  ARC.PhysChem.FOG_2.processed <- ARC.PhysChem.5_major_Lakes.processed %>%
    filter(Site =="Fog 2")
  
  #D Lake I7
  
  ARC.PhysChem.I7.processed <- ARC.PhysChem.5_major_Lakes.processed %>%
    filter(Site =="I7")
  
  #E Lake I5
  
  ARC.PhysChem.I5.processed <- ARC.PhysChem.5_major_Lakes.processed %>%
    filter(Site =="I5")
 
 
         
 #2 Check for Normality in the physical and Chemical parameters(temp, cond, pH, DO, chla, and Secchi depth)
 
    #A Toolik Lake Normality shapiro wilks test
  
          shapiro.test(ARC.PhysChem.Toolik.processed$Temp_C)
          shapiro.test(ARC.PhysChem.Toolik.processed$Cond_uS)
          shapiro.test(ARC.PhysChem.Toolik.processed$pH)
          shapiro.test(ARC.PhysChem.Toolik.processed$Chla_ug)
          shapiro.test(ARC.PhysChem.Toolik.processed$Dissolved_Oxygen)
          shapiro.test(ARC.PhysChem.Toolik.processed$PAR)
          shapiro.test(ARC.PhysChem.Toolik.processed$Secchi_Depth)
          
          
   #B  Lake E5 Normality shapiro wilks test
          
          shapiro.test(ARC.PhysChem.E5.processed$Temp_C)
          shapiro.test(ARC.PhysChem.E5.processed$Cond_uS)
          shapiro.test(ARC.PhysChem.E5.processed$pH)
          shapiro.test(ARC.PhysChem.E5.processed$Chla_ug)
          shapiro.test(ARC.PhysChem.E5.processed$Dissolved_Oxygen)
          shapiro.test(ARC.PhysChem.E5.processed$PAR)
          shapiro.test(ARC.PhysChem.E5.processed$Secchi_Depth)
  
  #C Lake Fog 2 Normality shapiro wilks test
          
          shapiro.test(ARC.PhysChem.FOG_2.processed$Temp_C)
          shapiro.test(ARC.PhysChem.FOG_2.processed$Cond_uS)
          shapiro.test(ARC.PhysChem.FOG_2.processed$pH)
          shapiro.test(ARC.PhysChem.FOG_2.processed$Chla_ug)
          shapiro.test(ARC.PhysChem.FOG_2.processed$Dissolved_Oxygen)
          shapiro.test(ARC.PhysChem.FOG_2.processed$PAR)
          shapiro.test(ARC.PhysChem.FOG_2.processed$Secchi_Depth)
          
    #D Lake I7 Normality shapiro wilks test
          
          shapiro.test(ARC.PhysChem.I7.processed$Temp_C)
          shapiro.test(ARC.PhysChem.I7.processed$Cond_uS)
          shapiro.test(ARC.PhysChem.I7.processed$pH)
          shapiro.test(ARC.PhysChem.I7.processed$Chla_ug)
          shapiro.test(ARC.PhysChem.I7.processed$Dissolved_Oxygen)
          shapiro.test(ARC.PhysChem.I7.processed$PAR)
          shapiro.test(ARC.PhysChem.I7.processed$Secchi_Depth)
  
  
    #E Lake I5 Normality shapiro wilks test
  
         shapiro.test(ARC.PhysChem.I5.processed$Temp_C)
         shapiro.test(ARC.PhysChem.I5.processed$Cond_uS)
         shapiro.test(ARC.PhysChem.I5.processed$pH)
         shapiro.test(ARC.PhysChem.I5.processed$Chla_ug)
         shapiro.test(ARC.PhysChem.I5.processed$Dissolved_Oxygen)
         shapiro.test(ARC.PhysChem.I5.processed$PAR)
         shapiro.test(ARC.PhysChem.I5.processed$Secchi_Depth)
         
 # 3 check for the homogeneity of variances between the 5 major lakes for water quality parameters
 
         bartlett.test(ARC.PhysChem.5_major_Lakes.processed$Temp_C ~ ARC.PhysChem.5_major_Lakes.processed$Site)
         bartlett.test(ARC.PhysChem.5_major_Lakes.processed$Cond_uS ~ ARC.PhysChem.5_major_Lakes.processed$Site)
         bartlett.test(ARC.PhysChem.5_major_Lakes.processed$pH ~ ARC.PhysChem.5_major_Lakes.processed$Site)
         bartlett.test(ARC.PhysChem.5_major_Lakes.processed$Chla_ug ~ ARC.PhysChem.5_major_Lakes.processed$Site)
         bartlett.test(ARC.PhysChem.5_major_Lakes.processed$Dissolved_Oxygen ~ ARC.PhysChem.5_major_Lakes.processed$Site)
         bartlett.test(ARC.PhysChem.5_major_Lakes.processed$PAR ~ ARC.PhysChem.5_major_Lakes.processed$Site)
         bartlett.test(ARC.PhysChem.5_major_Lakes.processed$Secchi_Depth ~ ARC.PhysChem.5_major_Lakes.processed$Site)
```



### Kruskal-Wallis Test and Dunn Test
I decided to use a nonparametric test to determine if there were significant differences between the 5 lakes for dissolved oxygen, PAR, Secchi depth, chlorophyll a concentrations, water temperature, and conductivity because the data did not meet the assumptions. I used a Kruskal Wallis Test to determine if there were significant differences between the 5 lakes for dissolved oxygen, PAR, Secchi depth, chlorophyll a concentrations, water temperature, and conductivity. Additionally, I used a Dunn Test to do a pairwise comparison of the different lakes to determine which lakes were significantly different for each of the six variables. 


```{r}
    # A. significant difference between lakes for (temp, cond, pH, DO, par, and chla) using kruskal wallis test
         
        Kruskal_Temp <-kruskal.test(ARC.PhysChem.5_major_Lakes.processed$Temp_C ~ as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        Kruskal_Temp
        
        Kruskal_Cond <- kruskal.test(ARC.PhysChem.5_major_Lakes.processed$Cond_uS ~ as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        Kruskal_Cond
        
        Kruskal_pH <-  kruskal.test(ARC.PhysChem.5_major_Lakes.processed$pH ~ as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        Kruskal_pH
        
        Kruskal_Chla <-  kruskal.test(ARC.PhysChem.5_major_Lakes.processed$Chla_ug ~ as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        Kruskal_Chla
        
        Kruskal_DO <-  kruskal.test(ARC.PhysChem.5_major_Lakes.processed$Dissolved_Oxygen  ~
                                      as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
         Kruskal_DO
         
        Kruskal_PAR <-  kruskal.test(ARC.PhysChem.5_major_Lakes.processed$PAR ~ as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        Kruskal_PAR
        
        # B. see which lake are significant different for (temp, cond, pH, DO, and chla) using the dunn test
        
        dunnTest(ARC.PhysChem.5_major_Lakes.processed$Temp_C , as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        dunnTest(ARC.PhysChem.5_major_Lakes.processed$Cond_uS , as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        dunnTest(ARC.PhysChem.5_major_Lakes.processed$pH , as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        dunnTest(ARC.PhysChem.5_major_Lakes.processed$Chla_ug , as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        dunnTest(ARC.PhysChem.5_major_Lakes.processed$Dissolved_Oxygen , as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        dunnTest(ARC.PhysChem.5_major_Lakes.processed$PAR , as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        
```

## Multiple Linear Regression Analysis to determine the significant factors in predicting Chlorophyll a concentrations
<Include R chunks for 3+ statistical tests (display code and output) and 3+ final visualization graphs (display graphs only).>

<Include text sections to accompany these R chunks to explain the reasoning behind your workflow, rationale for your approach, and the justification of meeting or failing to meet assumptions of tests.>


\newpage

# Summary and Conclusions
<Summarize your major findings from your analyses. What conclusions do you draw from your findings? Make sure to apply this to a broader application for the research question you have answered.>



