---
header-includes: 
- \usepackage{float} 
- \floatplacement{figure}{H} 
output: 
  pdf_document:
    keep_tex: yes
    fig_caption: yes
    number_sections: yes
geometry: margin=2.54cm
title: 
subtitle: "https://github.com/seabass72/Toolik.Lake.Chem.Project-"
author: "Sebastian Bognar"
abstract: "Experimental overview. This section should be no longer than 250 words."
fontsize: 12pt
mainfont: Times New Roman
---

<Information in these brackets are used for annotating the RMarkdown file. They will not appear in the final version of the PDF document>

\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

<Setup the global options for the R chunks in your document>

<Note: set up autoreferencing for figures and tables in your document>

```{r setup, include=FALSE}
# Set your working directory
setwd("/Users/Seabass/Documents/Duke/spring_2019/env_872L/lesson_2/Toolik.Lake.Chem.Project")

# Load your packages
library(tidyverse)
library(ggplot2)
library(lubridate)
library(nlme)
library(lsmeans)
library(multcompView)
library(naniar)
library(chron)
library(reshape2)
library(ggpubr)
library(FSA)
library(corrplot)
library(trend)
library(gridExtra)
library(ggsignif)
library(knitr)
library(bookdown)
library(car)

# Set your ggplot theme

theme_Final_Project <- theme_classic(base_size = 12) +
  theme(axis.text = element_text(color = "black"), 
        legend.position = "right", 
        axis.ticks = element_line(colour = "black"),
        panel.border = element_rect(fill= NA,color="black", size=0.5, 
                                    linetype="solid"),
        panel.grid.major.y =element_line(color = "grey"),
        panel.grid.minor.y = element_blank(),
        panel.grid.major.x  = element_blank(),
        panel.grid.minor.x  = element_blank(),
        axis.text.x = element_text(angle = 0,  hjust = 1),
        panel.background = element_rect(fill = "#bdbdbd", 
                                          size = 2, linetype = "solid"),
        panel.grid.major = element_line(size = 0.5, linetype = 'solid',
                                        colour = "white") )


```


# Research Question and Rationale

<Paragraph detailing the rationale for your analysis. What is the significant application and/or interest in this topic? Connect to environmental topic(s)/challenge(s).>

<Paragraph detailing your research question(s) and goals. What do you want to find out? Include a sentence (or a few) on the dataset you are using to answer this question - just enough to give your reader an idea of where you are going with the analysis.>

The first objective of the study was to understand if there were significant differences in the physical and chemical water quality characteristics between the five major lakes near the Toolik Field Station (E5, Fog 2, I7, I5, & Toolik Lakes). The next objective was to determine if there were any water quality parameters that were significant predictors of chlorophyll a concentrations in all the lakes in the study area (74 lakes). Finally, I wanted to see if there were any monotonic trends present within the distribution of chlorophyll a, dissolved oxygen, pH, water temperature, PAR, and conductivity for Toolik Lake. To answer these questions, I looked at chemical and physical water quality data for lakes near the Toolik Field Station. The dataset was collected during the summers from 2010-2014 and measured water quality data at a total of 74 lakes.

\newpage

# Dataset Information

<Information on how the dataset for this analysis were collected, the data contained in the dataset, and any important pieces of information that are relevant to your analyses. This section should contain much of same information as the README file for the dataset but formatted in a way that is more narrative.>

The dataset included the physical and chemical water quality measurements for various lakes that were located near the Toolik Lake Research Station in Alaska for the years: 2010-2014 (Table \ref{tab:table}). The data was collected as part of the Long Term Ecological Research (LTER) for the National Science Foundation (NSF). The water quality parameters that I used for my study were chlorophyll a concentration, dissolved oxygen concentration, pH, water temperature, photosynthetically active radiation, depth of measurement, secchi depth, and conductivity. The site descriptors for the dataset included site name, time, date, and depth. For the first objective of my analysis, I focused on five lakes that had the most observations: Toolik, E5, I7, I5, and Fog 2 Lake. Lake E5 also has undergone nutrient enrichment and the other four lakes are classified as reference lakes. 

To collect water quality data, A hydrolab Surveyor 4 data logger and Datsonde DS5 multiprobe were used to measure: depth (m), pH, specific conductivity (uS/cm), dissolved oxygen (mg/L), water temperature (Celsius), in-vivo fluorescence(chlorophyll a concentration), and photosynthetic active radiation (PAR) at half meter to meter intervals depending on the depth of the lake. To determine the secchi depth, A secchi disk (22 cm black and white disk) was used. There was only one depth for each site that was taken on a particular day for secchi depth. The data was only collected from June to August due to the lakes usually being frozen over for most of the year. 



```{r table,  echo = FALSE}




Names <-c("Site", "Date", "Depth_m", "Time_hr", "Temp_C", "Cond_uS", "pH", "Dissolved_Oxygen", "Chla_ug", "PAR", "Secchi_Depth")

Units <- c("Name", "YYYY-MM-DD","Meters","HH:MM", "Celsius", "uS/cm", "-log[H+]", "mg/L","ug/L","uE/m2/sec","Meters" )

Data_Structure <- c("Character", "Date", "Numeric","Character","Numeric","Numeric","Numeric","Numeric","Numeric","Numeric","Numeric")

data_ARC<- data.frame(Names, Units,  Data_Structure)

colnames(data_ARC)<- (c("Measurement", "Units",  "Data Structure"))

kable(data_ARC,caption="\\label{tab:table}Artic Lakes Data Summary")
```



<Add a table that summarizes your data structure. This table can be made in markdown text or inserted as a `kable` function in an R chunk. If the latter, do not include the code used to generate your table.>

\newpage

# Exploratory Data Analysis and Wrangling

## Summary Statistics for the Dataset

1. The dimensions of the dataset were 6239 rows and 20 columns. I wanted to understand the dimensions of the dataset so that I could understand how large of dataset was.


```{r}

# import the raw dataset 

ARC.PhysChem.2010_14.Raw <- read.csv(
  "./Data/RAW/ARC_Lakes_Physchem_2010-2014.csv")


# 1 dimensions of the dataset

dim(ARC.PhysChem.2010_14.Raw)

```

2. The column names of the dataset are presented below. I wanted to understand the chemical and physical water quality parameters that were present in the dataset with the colnames function.


```{r}
# 2 column names in the proceesed Toolik dataset

colnames(ARC.PhysChem.2010_14.Raw)
```


3. With the str function, I wanted to understand the structure and format of all the of the variables in the dataset.  


```{r}
# 3 determine the structure of the dataset

str(ARC.PhysChem.2010_14.Raw)
```


4. With the head function, I wanted to see how the dataset was organized and what measurements looked like in the dataset.


```{r}
# 4 the first 5 rows of the dataset 

head(ARC.PhysChem.2010_14.Raw)

```


5. I used the summary function, to see the distribution of the samples all of the variables in the dataset to get a better understanding of chemical and physical water quality parameters in the arctic region of Alaska. 


```{r}
# 5 look at the summary for each of the columns present in the dataset

summary(ARC.PhysChem.2010_14.Raw)
```

## Data Wrangling

1. The dataset had columns that I did not need for analysis, so used a pipe function to select the columns that I needed for my analysis.


```{r}

# 1 remove unnessary columns 

ARC.PhysChem.selectedcolumns.Raw <- ARC.PhysChem.2010_14.Raw %>%
  select("Site", "Date", "Rounded.Depth..m.", "Time_hr_dst","Temp_C",
         "Cond_uS", "pH","DO_mg.l","Chl_ug.l" , "PAR_uEm2s", "Secchi_m" ) 
  
```


2. The colnames were a bit long and I renamed the columns to make analysis more efficient.


```{r}
# 2 rename the columns with simpler names 
  
colnames(ARC.PhysChem.selectedcolumns.Raw) <- c("Site", "Date", "Depth_m", "Time_hr",
                                                "Temp_C", "Cond_uS", "pH","Dissolved_Oxygen","Chla_ug", "PAR", 
                                                "Secchi_Depth"  )
```


3. Areas with missing values would impede workflow and hinder my analyis, so missing values had to be removed. Values that were missing were labeled as periods and were hard to remove as periods. I converted the periods into NAs that could be easily removed from the dataset. I used the drop_na function remove the NAs from the dataset.


```{r}
# 3 make periods (missing values into NAs)
  
  ARC.PhysChem.selectedcolumns.Raw[ ARC.PhysChem.selectedcolumns.Raw == "." ] <- NA
  ARC.PhysChem.selectedcolumns.Raw[ ARC.PhysChem.selectedcolumns.Raw == "" ] <- NA
  
# remove the nas from the dataset
  
ARC.PhysChem.2010_2014.cleaned <- drop_na(ARC.PhysChem.selectedcolumns.Raw)
```


4. Many of the measurements were in the factor format, which were creating issues with many of the statistical models. I converted the measurements that were numeric into the numeric format and the ones that were characters into the character format.


```{r}
# 4 change columns that are numbers that are miss cateloged as
#factors with as.numeric and as.character

ARC.PhysChem.2010_2014.cleaned$Depth_m <- as.numeric(
  as.character(ARC.PhysChem.2010_2014.cleaned$Depth_m))

ARC.PhysChem.2010_2014.cleaned$Temp_C <- as.numeric(
  as.character(ARC.PhysChem.2010_2014.cleaned$Temp_C))

ARC.PhysChem.2010_2014.cleaned$Cond_uS <- as.numeric(
  as.character(ARC.PhysChem.2010_2014.cleaned$Cond_uS))

ARC.PhysChem.2010_2014.cleaned$pH <- as.numeric(
  as.character(ARC.PhysChem.2010_2014.cleaned$pH))

ARC.PhysChem.2010_2014.cleaned$Dissolved_Oxygen <- as.numeric(
  as.character(ARC.PhysChem.2010_2014.cleaned$Dissolved_Oxygen))

ARC.PhysChem.2010_2014.cleaned$Chla_ug <- as.numeric(
  as.character(ARC.PhysChem.2010_2014.cleaned$Chla_ug))

ARC.PhysChem.2010_2014.cleaned$PAR <- as.numeric(
  as.character(ARC.PhysChem.2010_2014.cleaned$PAR))

ARC.PhysChem.2010_2014.cleaned$Secchi_Depth <- as.character(
  ARC.PhysChem.2010_2014.cleaned$Secchi_Depth)

ARC.PhysChem.2010_2014.cleaned$Time_hr <- as.character(
  ARC.PhysChem.2010_2014.cleaned$Time_hr)

ARC.PhysChem.2010_2014.cleaned$Site <-as.character(
  ARC.PhysChem.2010_2014.cleaned$Site)


```

5. The date format was also in the factor format as well. if I wanted to graph or do further analysis, I would need the date in the date format. I used as.Date to convert the date into the date format.

```{r}
# 5 make sure that date column is in the date format 

ARC.PhysChem.2010_2014.cleaned$Date <- as.Date(
  ARC.PhysChem.2010_2014.cleaned$Date, "%d-%B-%y")



```


6. The secchi depth had characters (>Xm) inputted in with the measurements where the secchi disk hit bottom before the secchi depth was recorded. To fix this issue, I changed the values to "-1" and converted the format of the secchi depth to numeric. I saved the processed dataset in the Processed data folder.


```{r}
# 6 make secchi depths where hit bottom a number instead of a character (-1)

ARC.PhysChem.2010_2014.cleaned$Secchi_Depth[
  ARC.PhysChem.2010_2014.cleaned$Secchi_Depth == ">Xm"] <- -1

ARC.PhysChem.2010_2014.cleaned$Secchi_Depth <- as.numeric(
  ARC.PhysChem.2010_2014.cleaned$Secchi_Depth)

#  Save the processed dataset

write.csv(ARC.PhysChem.2010_2014.cleaned,
          file = "./Data/Processed/ARC.PhysChem.2010_2014.Processed.csv",row.names = FALSE)

```



## Data Exploration 

### Chlorophyll a Concentration vs. Depth Plot for the 5 Major Lakes near the Toolik Field Station


```{r fig1, echo=FALSE, fig.cap ="\\label{fig:fig1}The plot above shows the chlorophyll a concentrations(ug/L) vs. Depth (m) for five of the major lakes in the region.", fig.width=10, fig.height=6, fig.pos='H' }

# working with the cleaned dataset

ARC.PhysChem.2010_2014.processed<- ARC.PhysChem.2010_2014.cleaned

# 1 Plot to see Chlorophyll A concentration vs. Depth 

#filter for lakes with the most observations (top 5)

ARC.PhysChem.5_major_Lakes.processed <- ARC.PhysChem.2010_2014.processed %>%
  filter(Site == "Toolik"| Site == "E5" | Site == "Fog 2"|  Site == "I7"|  Site == "I5")



CHLA_DEPTH_PLOT <-  ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Chla_ug, y= Depth_m, color = Site)) +
  geom_point()+
  theme_Final_Project+
  scale_y_reverse( lim=c(20,0))+
  scale_colour_manual(values = c('#fed976','#feb24c','#fd8d3c','#f03b20','#bd0026'))+
  ylab("Depth (m)")+
  xlab(expression("Chlorophyll a Concentration"~"("*mu*g/L*")"))+
  ggtitle(" Chlorophyll a Concentrations vs. Depth for Lakes near the Toolik Field Station")+
  theme(plot.title = element_text(hjust = 0.5))+
  labs(color='Lake Name')

 CHLA_DEPTH_PLOT
```


The Chlorophyll a Concentration vs. Depth Plot diplays that chlorophyll a concentrations appear to be the highest upper water column(figure \ref{fig:fig1}). Additionally, it appears that Lake E5 has the highest concentration of chlorophyll a. Chlorophyll a appear to be present throughout the water column, even at deeper depths. Finally, it appears that Toolik and I7 Lake are the deepest lakes out of the five.

### Chlorophyll a Concentration vs. Time Plot for the 5 Major Lakes near the Toolik Field Station

The Chlorophyll a Concentration vs. Time Plot for the 5 Major Lakes near the Toolik Field Station appears to be showing an increasing trend from 2010 to 2014 (figure \ref{fig:fig2}). The Chlorophyll a concentrations seem to be highest in the early summer and decrease in the later summer months. Temperature and sunlight could be a likely cause of the decrease in the latter part of summer due to the fact that the lakes are located at higher latitudes. 

```{r fig2, echo=FALSE, fig.cap ="\\label{fig:fig2}The plot above shows the chlorophyll a concentrations(ug/L) vs. Time for five of the major lakes in the region.", fig.width=10, fig.height=6, fig.pos='H' }

 # 2 plot to see how chlorophyll a changes over Time (2010-2014)
 
 CHLA_Time_PLOT <-  ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Date, y= Chla_ug, color = Site)) +
   geom_point()+
   theme_Final_Project+
   scale_colour_manual(values = c('#d73027','#fc8d59','#fee08b','#d9ef8b','#91cf60'))+
   xlab("Date")+
   ylab(expression("Chloropyll a Concentration"~"("*mu*g/L*")"))+
   ggtitle(" Chlorophyll a Concentrations vs. Time for Lakes near the Toolik Field Station")+
   theme(plot.title = element_text(hjust = 0.5))+
   labs(color='Lake Name')+
   scale_x_date(date_breaks = "2 month", date_labels = "%m/%Y")+
   theme(axis.text.x = element_text(angle = 45,  hjust = 1))
 
 CHLA_Time_PLOT
 
 
```


### Physical and Chemical Water Quality Parameters Plot for Lakes near the Toolik Field Station

Physical and Chemical Water Quality Parameters plot show the distribution of Chlorophyll a, dissolved oxygen, pH, conductivity, water temperature, and photosynthetically active radiation (PAR) for the lakes: Toolik, E5, I7, I5, and Fog 2 (figure \ref{fig:fig3}). Lake E5 has the highest chlorophyll a concentration out of the five lakes whereas the other lakes have similar chlorophyll a distributions. There is a pretty even distribution of PAR across the five lakes, which makes sense because they are in the same general geographic location. Lake Fog 2 has the coldest water temperatures compared to the other lakes and the highest conductivity as well. Lake Fog 2 also has the highest dissolved oxygen concentration, which could be attributed to the colder water temperatures.The five lakes have differing pHs and Lake E5 has the lowest pH out of the lakes. 

```{r fig3, echo=FALSE, fig.cap ="\\label{fig:fig3}Physical and Chemical Water Quality Parameters for Lakes near the Toolik Field Station", fig.width=10, fig.height=8, fig.pos='H' }
 # 3 Water quality Measurements accross the five lakes (use gg arrange to make a graph with 5 plots)
 
 
 #  temperature plot
 
 LAKE.v.TEMP.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = Temp_C, fill =Site ))+
   geom_violin()+
   theme_Final_Project+
   ylab(expression("Temperature"*~degree*C))+
   theme(legend.position = "none")+
   scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
   theme(panel.background = element_rect(fill = "white", 
                                   size = 2, linetype = "solid"))+
   theme(panel.grid.major.y =element_blank())+
   theme(text = element_text(size=12))+
   theme(plot.title = element_text(hjust = 0.5))+
   theme(axis.title.x = element_blank())
   
 
 
 # conductivity plot 
 
 
 LAKE.v.COND.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = Cond_uS, fill =Site ))+
   geom_violin()+
   theme_Final_Project+
   ylab("Conductivity (uS/cm)")+
   theme(legend.position = "none")+
   scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
   theme(panel.background = element_rect(fill = "white", 
                                         size = 2, linetype = "solid"))+
   theme(panel.grid.major.y =element_blank())+
   theme(text = element_text(size=12))+
   theme(plot.title = element_text(hjust = 0.5))+
   theme(axis.title.x = element_blank())
 
 
 
 #pH plot
 LAKE.v.pH.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = pH, fill =Site ))+
   geom_violin()+
   theme_Final_Project+
   ylab("pH")+
   theme(legend.position = "none")+
   scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
   theme(panel.background = element_rect(fill = "white", 
                                         size = 2, linetype = "solid"))+
   theme(panel.grid.major.y =element_blank())+
   theme(text = element_text(size=12))+
   theme(plot.title = element_text(hjust = 0.5))+
   theme(axis.title.x = element_blank())
 
 
 
 # dissolved oxygen plot
 
 LAKE.v.DO.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = Dissolved_Oxygen, fill =Site ))+
   geom_violin()+
   theme_Final_Project+
   ylab("DO (mg/L)")+
   theme(legend.position = "none")+
   scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
   theme(panel.background = element_rect(fill = "white", 
                                         size = 2, linetype = "solid"))+
   theme(panel.grid.major.y =element_blank())+
   theme(text = element_text(size=12))+
   theme(plot.title = element_text(hjust = 0.5))+
   theme(axis.title.x = element_blank())
 
 
 
 # chla plot
 
 LAKE.v.chla.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = Chla_ug, fill =Site ))+
   geom_violin()+
   theme_Final_Project+
   ylab(expression("Chla Concentration"~"("*mu*g/L*")"))+
   theme(legend.position = "none")+
   scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
   theme(panel.background = element_rect(fill = "white", 
                                         size = 2, linetype = "solid"))+
   theme(panel.grid.major.y =element_blank())+
   theme(text = element_text(size=12))+
   theme(plot.title = element_text(hjust = 0.5))+
   theme(axis.title.x = element_blank())
 
 
 
 # PAR plot
 
 LAKE.v.PAR.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = PAR, fill =Site ))+
   geom_violin()+
   theme_Final_Project+
   ylab(expression("PAR"~"("*mu*E/m^2/sec*")"))+
   theme(legend.position = "none")+
   scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
   theme(panel.background = element_rect(fill = "white", 
                                         size = 2, linetype = "solid"))+
   theme(panel.grid.major.y =element_blank())+
   theme(text = element_text(size=12))+
   theme(plot.title = element_text(hjust = 0.5))+
   theme(axis.title.x = element_blank())
   
 
 

 # using gg arrange to put all the plots together 
 
 WATER_Q_Total_Plot <- ggarrange(LAKE.v.chla.PLOT,LAKE.v.PAR.PLOT, LAKE.v.TEMP.PLOT, LAKE.v.COND.PLOT, LAKE.v.DO.PLOT, LAKE.v.pH.PLOT,  ncol = 2, nrow = 3)
 WATER_Q_Total_Plot_complete<-annotate_figure(WATER_Q_Total_Plot,
                 top = text_grob("Physical and Chemical Water Quality Parameters for Lakes near the Toolik Field Station ", color = "black", face = "bold", size = 14))

 
 WATER_Q_Total_Plot_complete
 
```



<Include R chunks for 5+ lines of summary code (display code and output), 3+ exploratory graphs (display graphs only), and any wrangling you do to your dataset(s).> 

<Include text sections to accompany these R chunks to explain the reasoning behind your workflow, and the rationale for your approach.>


\newpage

# Analysis

## Statistical Analysis 1: Significant Differences between Lakes

### Separate Data and Check Assumptions 

First, I separated the five lakes into individal datasets, so that I could check the normality and homogeneity of variances. Normality and homogeneity of variances are key assumptions that need to be met if I want to run an ANOVA. I used a Shapiro-Wilks test to test if the data was normality distributed. However, the data was not normally distributed, which is common with water quality data. Similarly, the data did not meet the assumption of homogeneity of variances. 


```{r}
 # 1 separate water quality parameters for each of the five lakes 
 
  #A Toolik Lake
  ARC.PhysChem.Toolik.processed <- ARC.PhysChem.5_major_Lakes.processed %>%
    filter(Site =="Toolik" )
    
  
  #B LAke E5
  
  ARC.PhysChem.E5.processed <- ARC.PhysChem.5_major_Lakes.processed %>%
    filter(Site =="E5")
  
  #C Lake FOG 2
  
  ARC.PhysChem.FOG_2.processed <- ARC.PhysChem.5_major_Lakes.processed %>%
    filter(Site =="Fog 2")
  
  #D Lake I7
  
  ARC.PhysChem.I7.processed <- ARC.PhysChem.5_major_Lakes.processed %>%
    filter(Site =="I7")
  
  #E Lake I5
  
  ARC.PhysChem.I5.processed <- ARC.PhysChem.5_major_Lakes.processed %>%
    filter(Site =="I5")
 
 
         
 #2 Check for Normality in the physical and Chemical parameters(temp, cond, pH, DO, chla, and Secchi depth)
 
    #A Toolik Lake Normality shapiro wilks test
  
          shapiro.test(ARC.PhysChem.Toolik.processed$Temp_C)
          shapiro.test(ARC.PhysChem.Toolik.processed$Cond_uS)
          shapiro.test(ARC.PhysChem.Toolik.processed$pH)
          shapiro.test(ARC.PhysChem.Toolik.processed$Chla_ug)
          shapiro.test(ARC.PhysChem.Toolik.processed$Dissolved_Oxygen)
          shapiro.test(ARC.PhysChem.Toolik.processed$PAR)
          shapiro.test(ARC.PhysChem.Toolik.processed$Secchi_Depth)
          
          
   #B  Lake E5 Normality shapiro wilks test
          
          shapiro.test(ARC.PhysChem.E5.processed$Temp_C)
          shapiro.test(ARC.PhysChem.E5.processed$Cond_uS)
          shapiro.test(ARC.PhysChem.E5.processed$pH)
          shapiro.test(ARC.PhysChem.E5.processed$Chla_ug)
          shapiro.test(ARC.PhysChem.E5.processed$Dissolved_Oxygen)
          shapiro.test(ARC.PhysChem.E5.processed$PAR)
          shapiro.test(ARC.PhysChem.E5.processed$Secchi_Depth)
  
  #C Lake Fog 2 Normality shapiro wilks test
          
          shapiro.test(ARC.PhysChem.FOG_2.processed$Temp_C)
          shapiro.test(ARC.PhysChem.FOG_2.processed$Cond_uS)
          shapiro.test(ARC.PhysChem.FOG_2.processed$pH)
          shapiro.test(ARC.PhysChem.FOG_2.processed$Chla_ug)
          shapiro.test(ARC.PhysChem.FOG_2.processed$Dissolved_Oxygen)
          shapiro.test(ARC.PhysChem.FOG_2.processed$PAR)
          shapiro.test(ARC.PhysChem.FOG_2.processed$Secchi_Depth)
          
    #D Lake I7 Normality shapiro wilks test
          
          shapiro.test(ARC.PhysChem.I7.processed$Temp_C)
          shapiro.test(ARC.PhysChem.I7.processed$Cond_uS)
          shapiro.test(ARC.PhysChem.I7.processed$pH)
          shapiro.test(ARC.PhysChem.I7.processed$Chla_ug)
          shapiro.test(ARC.PhysChem.I7.processed$Dissolved_Oxygen)
          shapiro.test(ARC.PhysChem.I7.processed$PAR)
          shapiro.test(ARC.PhysChem.I7.processed$Secchi_Depth)
  
  
    #E Lake I5 Normality shapiro wilks test
  
         shapiro.test(ARC.PhysChem.I5.processed$Temp_C)
         shapiro.test(ARC.PhysChem.I5.processed$Cond_uS)
         shapiro.test(ARC.PhysChem.I5.processed$pH)
         shapiro.test(ARC.PhysChem.I5.processed$Chla_ug)
         shapiro.test(ARC.PhysChem.I5.processed$Dissolved_Oxygen)
         shapiro.test(ARC.PhysChem.I5.processed$PAR)
         shapiro.test(ARC.PhysChem.I5.processed$Secchi_Depth)
         
 # 3 check for the homogeneity of variances between the 5 major lakes for water quality parameters
 
         bartlett.test(ARC.PhysChem.5_major_Lakes.processed$Temp_C ~ ARC.PhysChem.5_major_Lakes.processed$Site)
         bartlett.test(ARC.PhysChem.5_major_Lakes.processed$Cond_uS ~ ARC.PhysChem.5_major_Lakes.processed$Site)
         bartlett.test(ARC.PhysChem.5_major_Lakes.processed$pH ~ ARC.PhysChem.5_major_Lakes.processed$Site)
         bartlett.test(ARC.PhysChem.5_major_Lakes.processed$Chla_ug ~ ARC.PhysChem.5_major_Lakes.processed$Site)
         bartlett.test(ARC.PhysChem.5_major_Lakes.processed$Dissolved_Oxygen ~ ARC.PhysChem.5_major_Lakes.processed$Site)
         bartlett.test(ARC.PhysChem.5_major_Lakes.processed$PAR ~ ARC.PhysChem.5_major_Lakes.processed$Site)
         bartlett.test(ARC.PhysChem.5_major_Lakes.processed$Secchi_Depth ~ ARC.PhysChem.5_major_Lakes.processed$Site)
```



### Kruskal-Wallis Test 
I decided to use a nonparametric test to determine if there were significant differences between the 5 lakes for dissolved oxygen, PAR, Secchi depth, chlorophyll a concentrations, water temperature, and conductivity because the data did not meet the assumptions. I used a Kruskal Wallis Test to determine if there were significant differences between the 5 lakes for dissolved oxygen, PAR, Secchi depth, chlorophyll a concentrations, water temperature, and conductivity.

There was a significant difference between the five major lakes for water temperature, conductivity, pH, dissolved oxygen, and chlorophyll a concentration (Kruskal Wallis: Table \ref{tab:table2}). There was also a significant difference between the five major lakes for PAR (Kruskal Wallis: Table \ref{tab:table2}). However, the significant difference was on a lower order of magnitude (Kruskal Wallis: Table \ref{tab:table2}). 

```{r table2,  echo = FALSE}




Constituent <-c( "Water Temperature", "Conductivity", "pH", "Dissolved Oxygen", "Chla Concentration", "PAR")

Chi <- c(120.93,1132.3,718.98,218.06,298.56,21.332)

P <- c("2.2e-16","2.2e-16","2.2e-16","2.2e-16","2.2e-16",0.00027)

df<- c(4,4,4,4,4,4)
data_wallis<- data.frame(Constituent, Chi, P, df)

colnames(data_wallis)<- (c("Constituent", "Chi-Squared",  "P-Value", "DF"))

kable(data_wallis,caption="\\label{tab:table2}Kruskal Wallis Test Results ")
```





```{r}
    # A. significant difference between lakes for (temp, cond, pH, DO, par, and chla) using kruskal wallis test
         
        Kruskal_Temp <-kruskal.test(ARC.PhysChem.5_major_Lakes.processed$Temp_C ~ 
                                      as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        Kruskal_Temp
        
        Kruskal_Cond <- kruskal.test(ARC.PhysChem.5_major_Lakes.processed$Cond_uS ~ 
                                       as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        Kruskal_Cond
        
        Kruskal_pH <-  kruskal.test(ARC.PhysChem.5_major_Lakes.processed$pH ~ 
                                      as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        Kruskal_pH
        
        Kruskal_Chla <-  kruskal.test(ARC.PhysChem.5_major_Lakes.processed$Chla_ug ~ 
                                        as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        Kruskal_Chla
        
        Kruskal_DO <-  kruskal.test(ARC.PhysChem.5_major_Lakes.processed$Dissolved_Oxygen  ~
                                      as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
         Kruskal_DO
         
        Kruskal_PAR <-  kruskal.test(ARC.PhysChem.5_major_Lakes.processed$PAR ~ 
                                       as.factor(ARC.PhysChem.5_major_Lakes.processed$Site))
        Kruskal_PAR
```
   
   

### Dunn Test


Additionally, I used a Dunn Test to do a pairwise comparison of the different lakes to determine which lakes were significantly different for each of the six variables. For pH, All of the five major lakes were significant differnet from one another, except for the comparison of Lake E5 to Lake I5 (Dunn Test; p < 0.0001, Figure \ref{fig:fig4}). Similarly, all the lakes' distribution of conductivity were significantly different from one another (Dunn Test; p < 0.0001, Figure \ref{fig:fig4}). The distribution of photosynthetically active radiation for all the lakes were not significantly different except for the comparison between lake Fog2 and Toolik Lake, which was significant (Dunn Test; p < 0.0001, Figure \ref{fig:fig4}). Most of chlorophyll a distributions were significantly different between the lakes (Dunn Test; p < 0.0001, Figure \ref{fig:fig4}), but the comparisons between I5 & I7, I5 & Toolik, and I7 & Toolik were not significant. For the  dissolved oxygen, a majority of the lakes had significantly different distributions, but the comparisons between: E5 & I5, E5 & I7, I5 & I7, and Fog 2 & Toolik did not have significantly different distributions. Finally, the majority of the lakes had significantly different distributions of water temperature (Dunn Test; p < 0.0001, Figure \ref{fig:fig4}), but the comparisons between E5 & I5, E5 & I7, I5 & I7, and I7 & Toolik were not significantly different. 



```{r fig4, echo=FALSE, warning=FALSE, fig.cap ="\\label{fig:fig4}The plot above shows the significant and non-significant differences between the five major lakes for chlorophyll a concentrations, PAR, dissolved oxygen, conductivity, water temperature, and pH. The signifance level is represented by: * (p < 0.01), ** (p < 0.001), *** ( p < 0.0001),NS = not significant. The blue lines also show that there is a significant difference between the lakes and red lines show a non- significant relationhip.", fig.width=11, fig.height=13, fig.pos='H'}
# 3  box plot of the water quality parameters with the significance levels for the dunn test
            
            
            # A chla dunn box plot
            
            Dunn_LAKE.v.chla.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = Chla_ug, fill =Site ))+
              geom_boxplot(outlier.size=-1)+
              theme_Final_Project+
              ylab(expression("Chla Concentration"~"("*mu*g/L*")"))+
              theme(legend.position = "none")+
              scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
              theme(panel.background = element_rect(fill = "white", 
                                                    size = 2, linetype = "solid"))+
              theme(panel.grid.major.y =element_blank())+
              theme(text = element_text(size=12))+
              theme(plot.title = element_text(hjust = 0.5))+
              theme(axis.title.x = element_blank())+
              geom_signif(comparisons = list(c("E5", "Fog 2")), 
                          map_signif_level=TRUE, annotations = "***", size=1, col= "blue")+
              geom_signif(comparisons = list(c("E5", "I5")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 27, size=1, col= "blue")+
              geom_signif(comparisons = list(c("E5", "I7")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 24, size=1, col= "blue")+
              geom_signif(comparisons = list(c("E5", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 21, size=1, col= "blue")+
              geom_signif(comparisons = list(c("Fog 2", "I5")), 
                          map_signif_level=TRUE, annotations = " ***", y_position = 19, size=1, col= "blue")+
              geom_signif(comparisons = list(c("Fog 2", "I7")), 
                          map_signif_level=TRUE, annotations = " ***", y_position = 16, size=1, col= "blue")+
              geom_signif(comparisons = list(c("Fog 2", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 13, size=1, col= "blue")+
              geom_signif(comparisons = list(c("I5", "I7")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 11.5, size=1, col= "red")+
              geom_signif(comparisons = list(c("I5", "Toolik")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 9, size=1, col= "red")+
            geom_signif(comparisons = list(c("I7", "Toolik")), 
                        map_signif_level=TRUE, annotations = "NS", y_position = 7.7, size=1, col= "red")
  
            
           
            
            # B water temperature dunn box plot
            
            Dunn_LAKE.v.temp.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = Temp_C, fill =Site ))+
              geom_boxplot(outlier.size=-1)+
              theme_Final_Project+
              ylab(expression("Water Temperature"*~(degree*C)))+
              theme(legend.position = "none")+
              scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
              theme(panel.background = element_rect(fill = "white", 
                                                    size = 2, linetype = "solid"))+
              theme(panel.grid.major.y =element_blank())+
              theme(text = element_text(size=12))+
              theme(plot.title = element_text(hjust = 0.5))+
              theme(axis.title.x = element_blank())+
              ylim(0,32)+
              geom_signif(comparisons = list(c("E5", "Fog 2")), 
                          map_signif_level=TRUE, annotations = "***", col ="blue", size=1)+
              geom_signif(comparisons = list(c("E5", "I5")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 31, col ="red", size=1)+
              geom_signif(comparisons = list(c("E5", "I7")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 29.5, col ="red", size=1)+
              geom_signif(comparisons = list(c("E5", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 28, col ="blue", size=1)+
              geom_signif(comparisons = list(c("Fog 2", "I5")), 
                          map_signif_level=TRUE, annotations = " ***", y_position = 26.5, col ="blue", size=1)+
              geom_signif(comparisons = list(c("Fog 2", "I7")), 
                          map_signif_level=TRUE, annotations = "        ***", y_position = 25, col ="blue", size=1)+
              geom_signif(comparisons = list(c("Fog 2", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 23, col ="blue", size=1)+
              geom_signif(comparisons = list(c("I5", "I7")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 21.2, col ="red", size=1)+
              geom_signif(comparisons = list(c("I5", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 19.0, col ="blue", size=1)+
              geom_signif(comparisons = list(c("I7", "Toolik")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 17.6, col ="red", size=1)
            
            
           
            
            # c pH dunn Box plot 
            
            Dunn_LAKE.v.pH.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = pH, fill =Site ))+
              geom_boxplot(outlier.size=-1)+
              theme_Final_Project+
              ylab("pH")+
              theme(legend.position = "none")+
              scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
              theme(panel.background = element_rect(fill = "white", 
                                                    size = 2, linetype = "solid"))+
              theme(panel.grid.major.y =element_blank())+
              theme(text = element_text(size=12))+
              theme(plot.title = element_text(hjust = 0.5))+
              theme(axis.title.x = element_blank())+
              ylim(6,15)+
              geom_signif(comparisons = list(c("E5", "Fog 2")), 
                          map_signif_level=TRUE, annotations = "***",y_position = 9, col ="blue", size=1)+
              geom_signif(comparisons = list(c("E5", "I5")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 15, col ="red", size=1)+
              geom_signif(comparisons = list(c("E5", "I7")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 14.2, col ="blue", size=1)+
              geom_signif(comparisons = list(c("E5", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 13.5, col ="blue", size=1)+
              geom_signif(comparisons = list(c("Fog 2", "I5")), 
                          map_signif_level=TRUE, annotations = " ***", y_position = 12.6, col ="blue", size=1)+
              geom_signif(comparisons = list(c("Fog 2", "I7")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 11.8, col ="blue", size=1)+
              geom_signif(comparisons = list(c("Fog 2", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 10.9, col ="blue", size=1)+
              geom_signif(comparisons = list(c("I5", "I7")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 10, col ="blue", size=1)+
              geom_signif(comparisons = list(c("I5", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 9.2, col ="blue", size=1)+
              geom_signif(comparisons = list(c("I7", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 8.5, col ="blue", size=1)
            
            
            
            
            
            # D conductivity dunn box plot 
            
            Dunn_LAKE.v.cond.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = Cond_uS, fill =Site ))+
              geom_boxplot(outlier.size=-1)+
              theme_Final_Project+
              ylab("Conductivity (uS/cm)")+
              theme(legend.position = "none")+
              scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
              theme(panel.background = element_rect(fill = "white", 
                                                    size = 2, linetype = "solid"))+
              theme(panel.grid.major.y =element_blank())+
              theme(text = element_text(size=12))+
              theme(plot.title = element_text(hjust = 0.5))+
              theme(axis.title.x = element_blank())+
              ylim(0,250)+
              geom_signif(comparisons = list(c("E5", "Fog 2")), 
                          map_signif_level=TRUE, annotations = "***",y_position = 250, col ="blue", size=1)+
              geom_signif(comparisons = list(c("E5", "I5")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 40, col ="blue", size=1)+
              geom_signif(comparisons = list(c("E5", "I7")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 115, col ="blue", size=1)+
              geom_signif(comparisons = list(c("E5", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 95, col ="blue", size=1)+
              geom_signif(comparisons = list(c("Fog 2", "I5")), 
                          map_signif_level=TRUE, annotations = " ***", y_position = 230, col ="blue", size=1)+
              geom_signif(comparisons = list(c("Fog 2", "I7")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 210, col ="blue", size=1)+
              geom_signif(comparisons = list(c("Fog 2", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 190, col ="blue", size=1)+
              geom_signif(comparisons = list(c("I5", "I7")), 
                          map_signif_level=TRUE, annotations = "**", y_position = 70, col ="blue", size=1)+
              geom_signif(comparisons = list(c("I5", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 132, col ="blue", size=1)+
              geom_signif(comparisons = list(c("I7", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 150, col ="blue", size=1)
            
            
           
            
            # E Dissolved Oxygen dunn boxplot 
            
            Dunn_LAKE.v.DO.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = Dissolved_Oxygen, fill =Site ))+
              geom_boxplot(outlier.size=-1)+
              theme_Final_Project+
              ylab("Dissolved Oxygen (mg/L)")+
              theme(legend.position = "none")+
              scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
              theme(panel.background = element_rect(fill = "white", 
                                                    size = 2, linetype = "solid"))+
              theme(panel.grid.major.y =element_blank())+
              theme(text = element_text(size=12))+
              theme(plot.title = element_text(hjust = 0.5))+
              theme(axis.title.x = element_blank())+
              ylim(7,17)+
              geom_signif(comparisons = list(c("E5", "Fog 2")), 
                          map_signif_level=TRUE, annotations = "***",y_position = 17, col ="blue", size=1)+
              geom_signif(comparisons = list(c("E5", "I5")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 16.1, col ="red", size=1)+
              geom_signif(comparisons = list(c("E5", "I7")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 15.5, col ="red", size=1)+
              geom_signif(comparisons = list(c("E5", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 14.9, col ="blue", size=1)+
              geom_signif(comparisons = list(c("Fog 2", "I5")), 
                          map_signif_level=TRUE, annotations = " ***", y_position = 14.4, col ="blue", size=1)+
              geom_signif(comparisons = list(c("Fog 2", "I7")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 13.6, col ="blue", size=1)+
              geom_signif(comparisons = list(c("Fog 2", "Toolik")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 13.0, col ="red", size=1)+
              geom_signif(comparisons = list(c("I5", "I7")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 11, col ="red", size=1)+
              geom_signif(comparisons = list(c("I5", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 12.4, col ="blue", size=1)+
              geom_signif(comparisons = list(c("I7", "Toolik")), 
                          map_signif_level=TRUE, annotations = "***", y_position = 11.7, col ="blue", size=1)
            
            
            
            
            
            # F PAR Dunn Box Plot 
            
            Dunn_LAKE.v.PAR.PLOT <- ggplot(ARC.PhysChem.5_major_Lakes.processed, aes(x= Site, y = PAR, fill =Site ))+
              geom_boxplot(outlier.size=-1)+
              theme_Final_Project+
              xlab(expression("PAR"~"("*mu*E/m^2/sec*")"))+
              theme(legend.position = "none")+
              scale_fill_manual(values = c('#b2182b','#ef8a62','#fddbc7','#e0e0e0','#999999'))+
              theme(panel.background = element_rect(fill = "white", 
                                                    size = 2, linetype = "solid"))+
              theme(panel.grid.major.y =element_blank())+
              theme(text = element_text(size=12))+
              theme(plot.title = element_text(hjust = 0.5))+
              theme(axis.title.x = element_blank())+
              ylim(0, 700)+
              geom_signif(comparisons = list(c("E5", "Fog 2")), 
                          map_signif_level=TRUE, annotations = "NS",y_position = 700, col ="red",size=1)+
              geom_signif(comparisons = list(c("E5", "I5")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 610, col ="red",size=1)+
              geom_signif(comparisons = list(c("E5", "I7")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 540, col ="red",size=1)+
              geom_signif(comparisons = list(c("E5", "Toolik")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 475, col ="red",size=1)+
              geom_signif(comparisons = list(c("Fog 2", "I5")), 
                          map_signif_level=TRUE, annotations = " NS", y_position = 220, col ="red",size=1)+
              geom_signif(comparisons = list(c("Fog 2", "I7")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 350, col ="red",size=1)+
              geom_signif(comparisons = list(c("Fog 2", "Toolik")), 
                          map_signif_level=TRUE, annotations = "**", y_position = 410, col ="blue",size=1)+
              geom_signif(comparisons = list(c("I5", "I7")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 280, col ="red",size=1)+
              geom_signif(comparisons = list(c("I5", "Toolik")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 700, col ="red",size=1)+
              geom_signif(comparisons = list(c("I7", "Toolik")), 
                          map_signif_level=TRUE, annotations = "NS", y_position = 200, col ="red", size=1)
            
            
            
            
            # using ggarrange to group the plots together (2 at a time), can't fit all three without compromising 
            # the comparison bars 
            
            par(mfrow = c(3, 2))
            
              # dunn plot (chla, temp)
              Dunn_Plot_CHLA_TEMP <- ggarrange(Dunn_LAKE.v.chla.PLOT, Dunn_LAKE.v.temp.PLOT,  nrow=1, ncol =2)
            
              
               # dunn plot (PAR, COND)
               Dunn_Plot_par_cond <- ggarrange(Dunn_LAKE.v.PAR.PLOT, Dunn_LAKE.v.cond.PLOT,  nrow=1, ncol =2)
               
             
               
               # dunn plot (DO, pH)
               Dunn_Plot <- ggarrange(Dunn_LAKE.v.pH.PLOT, Dunn_LAKE.v.DO.PLOT, Dunn_LAKE.v.PAR.PLOT,
                              Dunn_LAKE.v.cond.PLOT, Dunn_LAKE.v.chla.PLOT, Dunn_LAKE.v.temp.PLOT , nrow=3, ncol =2)
                              
              dunn_plot_complete<- annotate_figure(Dunn_Plot,top = text_grob(
              "Significant Differences Between the Five Major Lakes for Physical and Chemical Water Quality Parameters",                size = 15))
               
               dunn_plot_complete
               
      
```
  
   
   
   
``` {r}     
        # B. see which lake are significant different for (temp, cond, pH, DO, and chla) using the dunn test
        
        dunnTest(ARC.PhysChem.5_major_Lakes.processed$Temp_C , as.factor(
          ARC.PhysChem.5_major_Lakes.processed$Site))
        dunnTest(ARC.PhysChem.5_major_Lakes.processed$Cond_uS , as.factor(
          ARC.PhysChem.5_major_Lakes.processed$Site))
        dunnTest(ARC.PhysChem.5_major_Lakes.processed$pH , as.factor(
          ARC.PhysChem.5_major_Lakes.processed$Site))
        dunnTest(ARC.PhysChem.5_major_Lakes.processed$Chla_ug , as.factor(
          ARC.PhysChem.5_major_Lakes.processed$Site))
        dunnTest(ARC.PhysChem.5_major_Lakes.processed$Dissolved_Oxygen , as.factor(
          ARC.PhysChem.5_major_Lakes.processed$Site))
        dunnTest(ARC.PhysChem.5_major_Lakes.processed$PAR , as.factor(
          ARC.PhysChem.5_major_Lakes.processed$Site))
        
```

## 2 Multiple Linear Regression Analysis to determine the significant factors in predicting Chlorophyll a concentrations

### Assumptions that have to be met for a Multiple Linear Regression  

The four assumptions that have to be met are for a Multiple Linear Regression:

1. linear relationship between the variables 
2. normal distribution
3. equal variance
4. No Multicollinearity


### Checking the Normality of the log Transformed Chlorophyll a Concentration and the Multicollinearity of the Data

Due to the lack of normality, I log transformed the chlorophyll a concentration (dependent variable). I also removed the zeros from the dataset because the log of zero is undefined and would not allow the multiple linear regression to work. I used a shapiro wilks test and looked at the qq plot to determine if the chlorophyll a concentration was normally distributed. The shapiro wilks test showed that the distribution was still not normally distributed (Shapiro Wilks, p =0.002). However before the log transformation, the distribution was heavily skewed (Shapiro Wilks, p< 2.2e-16). The qq plot showed that the log transformed distribution relatively follows a normal distribution, so I assumed that it was a normal distribution. I then looked at the Variance Inflation Factors (VIF) of all the variables and none of them had a VIF greater than 10. This indicates that the data has met the assumption of no multicollinearity. 

```{r }
# 1 remove chla concentrations that are zero for log transformation of dependent variable
        ARC.PhysChem.all_Lakes.nozeros<- ARC.PhysChem.2010_2014.processed %>%
        filter(Chla_ug > 0 )
        
        
# 2 check normality of the of dependent variable (chlorophyll a) with log transformation
        
        # use the shapiro wilks test to test normality
        
        shapiro.test(log(ARC.PhysChem.all_Lakes.nozeros$Chla_ug)) # much improved (p value = 10^-16 -> 0.00214)
        
        # look at the improvement in qqplot 
        
        qqnorm(log(ARC.PhysChem.all_Lakes.nozeros$Chla_ug))
        qqline(log(ARC.PhysChem.all_Lakes.nozeros$Chla_ug))
        
# Multicollinearity using the VIF from the car package
        
  vif(lm(log(Chla_ug)~Temp_C + Cond_uS + pH + Dissolved_Oxygen+PAR+Secchi_Depth, data=ARC.PhysChem.all_Lakes.nozeros))
```

### Run Basic Multiple Linear Regression and Look at Diagnostic plots to see if other Assumptions were Met

I ran a multiple linear regression for the full model: log(Chla_ug) = Temp_C + Cond_uS + pH + Dissolved_Oxygen + PAR +Secchi_Depth. I then looked at the diagnostic plots to see if the assumptions for the multiple linear regression were met. The Residuals vs. Fitted plot, which determines if the variables flow alinear relationship, showed a relatively horizontal line through zero (Figure \ref{fig:fig5}). This indicates that the data does in fact have a linear relationship. The Scale to Location Plot (looks at the assumption of equal variance) showed that the points were relatively randomly distributed and line was almost horizontal, which indicated that the data fulfills the assumption of homogeneity of variances (Figure \ref{fig:fig5}). Finally, the Residuals to Leverage plot shows that none of the outliers are outside the cook's distance, which indicates that none of the outliers have significant pull on the outcome of the model (Figure \ref{fig:fig5}). 





```{r fig5, fig.cap ="\\label{fig:fig5}The plot above shows the four diagnostic plots: qq plot, Residuals vs. Fitted Plot, Scale to Location Plot, and Residuals to Leverage Plot. "}
# run multiple linear regression (full model)
        
CHLA_MODEL <- lm(data = ARC.PhysChem.all_Lakes.nozeros, log(Chla_ug)~Temp_C + Cond_uS + pH + Dissolved_Oxygen+PAR+Secchi_Depth)

summary(CHLA_MODEL)


# check Diagnostic Plots for Linear Regression Analysis

par(mfrow = c(3, 2))

 plot(CHLA_MODEL)
 

```

### Find the Multiple Linear Regression Model of Best Fit


With all the assumptions for the multiple linear regression met, I used a step-AIC to determine the model of best fit. The equation of best fit was: 

log(Chla concentration) = 4.409 - 0.0474*(Water Temp.) - 0.331 *(pH) - 0.0010* (PAR) - 0.133 *(Secchi Depth)

or 

Back-transformed : 

Chla concentration = 82.19 - 1.05*(Water Temp.) - 1.39*(pH) - 1.00*(PAR) - 1.14*(Secchi Depth)


Water temperature, pH, PAR, and Secchi depth were significant predictors of chlorophyll a concentrations in lakes near the Toolik Field Station (MLR; Table \ref{tab:table3} ). The multiple linear regression model explained 39.11 % of the variation in the chlorophyll a concentration (MLR; p < 0.0001; R^2 = 0.391; df = 3249). With a 1 degree increase in water temperature, there would be a 1.05 mg/L decrease in chlorophyll a concentration (Figure \ref{fig:fig6}). With a 1 unit increase in pH, there would be a 1.39 mg/L decrease in chlorophyll a concentrations (Figure \ref{fig:fig6}). Additionally, a 1 einstein increase in PAR would lead to a 1 mg/L decrease in chlorophyll a concentration (Figure \ref{fig:fig6}). Finally, a 1 meter increase in secchi depth would lead to a 1.14 mg/L decrease in chlorophyll a cocnetration (Figure \ref{fig:fig6}).

```{r table3,  echo = FALSE}




Constituent <-c( "Intercept","Water Temperature", "pH", "PAR", "Secchi Depth")

T <- c(27.00,-14.16,-13.06,-20.96,-19.61)

P <- c("2.0e-16","2.0e-16","2.0e-16","2.0e-16","2.0e-16")

data_MLR<- data.frame(Constituent, T, P)

colnames(data_MLR)<- (c("Model Variable", "T-Value",  "P-Value"))

kable(data_MLR,caption="\\label{tab:table3}Multiple Linear Regression Coefficients")
```


```{r fig6, echo=FALSE, warning=FALSE, fig.cap ="\\label{fig:fig6}The plot above shows the significant predictors of Chlorophyll a concentration in Lakes near the Toolik Field Station. The significant predictors of chlorophyll a concentrations are water temperature, PAR, pH, and secchi depth", fig.width=11, fig.height=10, fig.pos='H'}
# 2 plots of the independent variables that were significant vs. Chla (multiple linear regression plot)
            
            #Chla vs. water temp plot
            
            MLR_ALL.chla.temp.plot <-  ggplot(ARC.PhysChem.all_Lakes.nozeros, aes(x= Temp_C, y= Chla_ug, col =Chla_ug)) +
              geom_point(alpha=0.5)+
              theme_Final_Project+
              xlab(expression("Water Temperature"*~(degree*C)))+
              ylab(expression("Chloropyll a Concentration"~"("*mu*g/L*")"))+
              labs(color = expression("Chla"~"("*mu*g/L*")"))+
              theme(plot.title = element_text(hjust = 0.5))+
              geom_smooth(method=lm,se=TRUE, col = "black")+
              theme(panel.background = element_rect(fill = "white", 
                                                    size = 2, linetype = "solid"))+
              theme(panel.grid.major.y =element_blank())+
              scale_color_gradient(low="blue", high="green")
            
            
           
            
            #Chla vs. pH plot
            
            MLR_ALL.pH.plot <-  ggplot(ARC.PhysChem.all_Lakes.nozeros, aes(x= pH, y= Chla_ug, col =Chla_ug)) +
              geom_point(alpha=0.5)+
              theme_Final_Project+
              xlab(("pH"))+
              ylab(expression("Chloropyll a Concentration"~"("*mu*g/L*")"))+
              labs(color = expression("Chla"~"("*mu*g/L*")"))+
              theme(plot.title = element_text(hjust = 0.5))+
              geom_smooth(method=lm,se=TRUE, col = "black")+
              theme(panel.background = element_rect(fill = "white", 
                                                    size = 2, linetype = "solid"))+
              theme(panel.grid.major.y =element_blank())+
              scale_color_gradient(low="blue", high="green")
            
            
            
            
            #Chla vs. PAR plot
            
            MLR_ALL.chla.PAR.plot <-  ggplot(ARC.PhysChem.all_Lakes.nozeros, aes(x= PAR, y= Chla_ug, col =Chla_ug)) +
              geom_point(alpha=0.5)+
              theme_Final_Project+
              xlab(expression("PAR"~"("*mu*E/m^2/sec*")"))+
              ylab(expression("Chloropyll a Concentration"~"("*mu*g/L*")"))+
              labs(color = expression("Chla"~"("*mu*g/L*")"))+
              theme(plot.title = element_text(hjust = 0.5))+
              geom_smooth(method=lm,se=TRUE, col = "black")+
              theme(panel.background = element_rect(fill = "white", 
                                                    size = 2, linetype = "solid"))+
              theme(panel.grid.major.y =element_blank())+
              scale_color_gradient(low="blue", high="green")
            
            
            
            
            
            #Chla vs. PAR plot
            
            MLR_ALL.chla.secchi.plot <-  ggplot(ARC.PhysChem.all_Lakes.nozeros, aes(x= Secchi_Depth, y= Chla_ug, col =Chla_ug)) +
              geom_point(alpha=0.5)+
              theme_Final_Project+
              xlab("Secchi Depth (m)")+
              ylab(expression("Chloropyll a Concentration"~"("*mu*g/L*")"))+
              labs(color = expression("Chla"~"("*mu*g/L*")"))+
              theme(plot.title = element_text(hjust = 0.5))+
              geom_smooth(method=lm,se=TRUE, col = "black")+
              theme(panel.background = element_rect(fill = "white", 
                                                    size = 2, linetype = "solid"))+
              theme(panel.grid.major.y =element_blank())+
              scale_color_gradient(low="blue", high="green")+
              xlim(0, 12)
            
            
          
            
            # put all the plots together with ggarrange
            
           MLR_PLOT <-ggarrange(MLR_ALL.chla.temp.plot, MLR_ALL.pH.plot,  MLR_ALL.chla.secchi.plot,MLR_ALL.chla.PAR.plot,  ncol = 2, nrow = 2)
            MLR.plot.complete<-annotate_figure(MLR_PLOT,
                                                        top = text_grob(" Significant Predictors of Chlorophyll a Concentration in Lakes near the Toolik Field Station ", color = "black", face = "bold", size = 14, hjust = 0.5))
            
            
            MLR.plot.complete
            
            
```



```{r}

# use Step-AIC to find the model of best fit
 
 step(CHLA_MODEL)
 
 # model of best fit
 
 CHLA_MODEL_Best <- lm(data = ARC.PhysChem.all_Lakes.nozeros, log(Chla_ug)~Temp_C + pH + PAR+Secchi_Depth)
 
 summary(CHLA_MODEL_Best)
 
```


### Mann Kendall Test to determine the Presence of Montonic Trends 

Due to the fact that the other lakes did not have enough observations when looking at depth = zero, I only looked at data from Toolik Lake for the trend analysis. I looked for monotonic trends within the entirety of the time series for water temperature, conductivity, pH, dissolved oxygen, PAR, and chlorophyll a concentrations using the mann-kendall test. Additionally, I used the Pettitt test determine the change points within the datasets. 

Chlorophyll a concentrations at Toolik Lake from June 2010 - August 2012 showed a significant positive trend (Mann-Kendall;s = 958, p < 0.001; Figure \ref{fig:fig7}). The change point was located at 8/25/2012 and there were no significant monotonic trends from August 2012- August 2014 (Pettitt Test; k = 33; p < 0.0001 ). There were no significant monotonic trends present for pH, PAR, and conductivity at Toolik Lake from June 2010 - August 2014. Water tempature at Toolik Lake from June 2010 - August 2012 showed a significant negative trend (Mann-Kendall;s = -432, p = 0.01; Figure \ref{fig:fig7}). The change point was located at 8/17/2012 and there were no significant monotonic trends from August 2012- August 2014 (Pettitt Test; k = 33; p < 0.0001 ). Finally, dissolved oxygen concentration at Toolik Lake from June 2010 - August 2012 showed a significant positive trend (Mann-Kendall;s = 423, p = 0.012; Figure \ref{fig:fig7}). The change point was located at 8/03/2012 and there were no significant monotonic trends from August 2012- August 2014 (Pettitt Test; k = 33; p = 0.0043 ).

```{r fig7, echo=FALSE, warning=FALSE, fig.cap ="\\label{fig:fig7}The plot above shows the constituents: chlorophyll a concentration, water temperature, & dissolved oxygen that experience significant monotonic trends during the time frame of June, 2010 - August 2014. The dash lines represent the change points of the monotonic trend for each constituent and the solid lines represent the direction of the trend. There were no significant trends that occurred after August, 2012. ", fig.width=11, fig.height=10, fig.pos='H'}
             
##### 1 plot for mann kendal trend test ( total of 6 graphs that will be grouped togehter)

          # filter out samples for single depth (depth == 0)
             
             ARC.PhysChem.Toolik_zero.processed<- ARC.PhysChem.Toolik.processed %>%
               filter(Depth_m == 0)
             
    # A Chla vs. time plot for toolik lake with change points and trend line for parts with significant trends
            
             CHLA_Time_Toolik_PLOT <-  ggplot(ARC.PhysChem.Toolik_zero.processed, aes(x= Date, y= Chla_ug, color = Chla_ug)) +
               geom_point()+
               theme_Final_Project+
               #scale_colour_manual(values = c('#d73027','#fc8d59','#fee08b','#d9ef8b','#91cf60'))+
               xlab("Date")+
               ylab(expression("Chloropyll a Concentration"~"("*mu*g/L*")"))+
               ggtitle(" Chlorophyll a Concentrations vs. Time for Toolik Lake")+
               theme(plot.title = element_text(hjust = 0.5))+
               labs(color = expression("Chla Conc."~"("*mu*g/L*")"))+
               scale_x_date(date_breaks = "3 month", date_labels = "%m/%Y")+
               theme(axis.text.x = element_text(angle = 45,  hjust = 1))+
               scale_color_gradient(low="blue", high="green")+
               geom_vline(xintercept=as.Date("2012-08-25"), linetype="dashed", col = 'black')+
               geom_smooth(method=lm,se=TRUE, col = "black")+
               theme(panel.background = element_rect(fill = "white", 
                                                     size = 2, linetype = "solid"))+
               theme(panel.grid.major.y =element_blank())
             
             
             
             # B Water Temperature vs. time plot for toolik lake with change points and trend line for parts with significant trends
             
             TEMP_Time_Toolik_PLOT <-  ggplot(ARC.PhysChem.Toolik_zero.processed, aes(x= Date, y= Temp_C, color = Temp_C)) +
               geom_point()+
               theme_Final_Project+
               #scale_colour_manual(values = c('#d73027','#fc8d59','#fee08b','#d9ef8b','#91cf60'))+
               xlab("Date")+
               ylab(expression("Water Temperature"*~degree*C))+
               ggtitle(" Water Temperature vs. Time for Toolik Lake")+
               theme(plot.title = element_text(hjust = 0.5))+
               labs(color=expression("Temp."*~degree*C))+
               scale_x_date(date_breaks = "3 month", date_labels = "%m/%Y")+
               theme(axis.text.x = element_text(angle = 45,  hjust = 1))+
               scale_color_gradient(low="blue", high="red")+
               geom_vline(xintercept=as.Date("2012-08-03"), linetype="dashed", col = 'black')+
               geom_smooth(method=lm,se=TRUE, col = "black", show.legend = TRUE)+
               theme(panel.background = element_rect(fill = "white", 
                                                     size = 2, linetype = "solid"))+
               theme(panel.grid.major.y =element_blank())
             
             
            
          
            
            # C DO vs. time plot for toolik lake with change points and trend line for parts with significant trends
            
            
            DO_Time_Toolik_PLOT <-  ggplot(ARC.PhysChem.Toolik_zero.processed, aes(x= Date, y= Dissolved_Oxygen, color = Dissolved_Oxygen)) +
              geom_point()+
              theme_Final_Project+
              xlab("Date")+
              ylab("Dissolved Oxygen (mg/L)")+
              ggtitle("Dissolved Oxygen vs. Time for Toolik Lake")+
              theme(plot.title = element_text(hjust = 0.5))+
              labs(color='DO (mg/L)')+
              scale_x_date(date_breaks = "3 month", date_labels = "%m/%Y")+
              theme(axis.text.x = element_text(angle = 45,  hjust = 1))+
              scale_color_gradient(low="red", high="blue")+
              geom_vline(xintercept=as.Date("2012-08-17"), linetype="dashed", col = 'black')+
              geom_smooth(method=lm,se=TRUE, col = "black", show.legend = TRUE)+
              theme(panel.background = element_rect(fill = "white", 
                                                    size = 2, linetype = "solid"))+
              theme(panel.grid.major.y =element_blank())
          
             
            # use gg arrange to put all the plots together 
            
            Mann_Kendall_Plot <- ggarrange(CHLA_Time_Toolik_PLOT,TEMP_Time_Toolik_PLOT,  DO_Time_Toolik_PLOT,  ncol = 1, nrow = 3)
            MAnn_Kendall_Plot_complete<-annotate_figure(Mann_Kendall_Plot,
                                                         top = text_grob(" Mann- Kendall Trend Analysis for Toolik Lake", color = "black", face = "bold", size = 16, hjust = 0.625))
            
            
            MAnn_Kendall_Plot_complete
```




```{r}
########### statistical test 3 mann-kendall test for Toolik Lake looking for change points (temp, cond, pH, DO, par, and chla)
 
 
 #Toolik lake mann-kendall test intial for chla 

             
             # Initial Mann Kendall Test
             mk.test(ARC.PhysChem.Toolik_zero.processed$Chla_ug)
             
             # use the pettitt test determine the change points in the seasons 
             
             pettitt.test(ARC.PhysChem.Toolik_zero.processed$Chla_ug) # show a likely change point at point 33
             
             # confirm change point with mann kendall test for [1:32]
             
             mk.test(ARC.PhysChem.Toolik_zero.processed$Chla_ug[1:32])
             
             # use pettitt test on latter half of data to find next change point
             
             pettitt.test(ARC.PhysChem.Toolik_zero.processed$Chla_ug[33:63]) # not significant 
             
             
# mann kendall test for temp in toolik lake
             
             # Initial Mann Kendall Test
             mk.test(ARC.PhysChem.Toolik_zero.processed$Temp_C)
             
             # use the pettitt test determine the change points in the seasons 
             
             pettitt.test(ARC.PhysChem.Toolik_zero.processed$Temp_C) # show a likely change point at point 31
             
             # confirm change point with mann kendall test for [1:30]
             
             mk.test(ARC.PhysChem.Toolik_zero.processed$Temp_C[1:30])
             
             # use pettitt test on latter half of data to find next change point
             
             pettitt.test(ARC.PhysChem.Toolik_zero.processed$Chla_ug[31:63]) # not significant 
             
             
# mann kendall test for pH in toolik lake
             
             # Initial Mann Kendall Test
             mk.test(ARC.PhysChem.Toolik_zero.processed$pH) # no significant change point for pH
             
# mann kendall test for conductivity in toolik lake
             
             # Initial Mann Kendall Test
             mk.test(ARC.PhysChem.Toolik_zero.processed$Cond_uS) # not significant 
             
            
# mann kendall test for dissolved O in toolik lake
             
             # Initial Mann Kendall Test
             mk.test(ARC.PhysChem.Toolik_zero.processed$Dissolved_Oxygen)
             
             # use the pettitt test determine the change points in the seasons 
             
             pettitt.test(ARC.PhysChem.Toolik_zero.processed$Dissolved_Oxygen) # show a likely change point at point 32
             
             # confirm change point with mann kendall test for [1:31]
             
             mk.test(ARC.PhysChem.Toolik_zero.processed$Dissolved_Oxygen[1:31])
             
             # use pettitt test on latter half of data to find next change point
             
             pettitt.test(ARC.PhysChem.Toolik_zero.processed$Chla_ug[31:63]) # not significant
             
             
 # mann kendall test for PAR in toolik lake
             
             # Initial Mann Kendall Test
             mk.test(ARC.PhysChem.Toolik_zero.processed$PAR) # not significant, no further analysis with pettitt test
             
            

```




<Include R chunks for 3+ statistical tests (display code and output) and 3+ final visualization graphs (display graphs only).>

<Include text sections to accompany these R chunks to explain the reasoning behind your workflow, rationale for your approach, and the justification of meeting or failing to meet assumptions of tests.>


\newpage

# Summary and Conclusions
<Summarize your major findings from your analyses. What conclusions do you draw from your findings? Make sure to apply this to a broader application for the research question you have answered.>

Most of the five lakes (Toolik, E5, I7, I5, and Fog 2) were significantly different in terms of physical and chemical parameters (Figure \ref{fig:fig4}). The separation of the lakes in the  same general location near the Toolik Field station has allowed them to have contrasting physical and chemical water quality parameters. However, the lakes that were closer together such as I5 and I7 did not differ that much significantly. The size and volume of the lake is most likely a contributing factor to the physical and chemical composition of the lakes. I did not have access to these measurements with my dataset. 

Additionally, I determined that water temperature, pH, secchi depth, and photosynthetically active radiation are significantly predictors for chlorophyll a concentrations in Lakes near the Toolik Field station (Figure \ref{fig:fig5}). As the water temperature, pH, secchi depth, and photosynthetically active radiation increased, there was a decrease in chlorophyll a concentrations. Nutrient concentration measurements within in the lakes are also key to create a more complete model due to the fact that arctic lakes such as Toolik Lake are nutrient limited (O'Brien et al., 1997). The increase in PAR intensity decreasing chlorophyll a concentrations is plausible because higher intensities of PAR can lead to increases in other chlorophyll pigments (Donahue et al., 2003). There is also a strong correlation between chlorophyll a concentration and secchi depth (Hessen 2006). Secchi depth increases when water is clearer and an increase chlorophyll a concentration decreases water clarity. The increase in temperature and pH decreasing chlorophyll a concentrations is not what I would have expected. Other arctic lakes had the highest chlorophyll concentrations when the pH and temperature were the highest in the late summer (French & Petticrew 2007). The decrease in nutrients that occurs near the end of summer could be the reason for the decreases in chl a concentrations and misrepresentation of the relationship of pH and water temperature with chlorophyll a concentrations(O'Brien et al., 1997).  


There was positive increasing trends for chlorophyll a concentration and dissolved oxygen between June, 2010 to August, 2012. The increase in chlorophyll a concentration could be due to the increase in annual temperatures and increased mixing within the arctic lakes (Michelutti et al., 2005). The increase in dissolved oxygen could probably be attributed to the increase in chlorophyll a concentrations because photosynthesis produces oxygen. There was also a decreasing trend of water temperature from June, 2010 to August, 2012. This could be due to later ice off periods or changes in wind patterns. Air temperature and additional climatic information is needed to determine the cause of the colder water water temperatures from 2010-2012. 


The lakes near the Toolik Field station are significantly different and have several monotonic trends over the course of the study period. However, longer sampling periods are necessary to gain a better understanding of the physical and chemical water quality parameters at the lakes. Nutrient concentration sampling is key to understand the chlorophyll a  fluctuations because the lakes are most likely nutrient-limited. To understand the significant predictors of chlorophyll a concentrations in the arctic, there has to be nutrient water quality sampling and an increase in sampling frequency among the lakes.  
 

\newpage

# References

Donahue, William F., et al. "The role of solar radiation in structuring the shallow benthic communities of boreal forest lakes." Limnology and Oceanography 48.1 (2003): 31-47.

French, T. D., & Petticrew, E. L. (2007). Chlorophyll a seasonality in four shallow eutrophic lakes (northern British Columbia, Canada) and the critical roles of internal phosphorus loading and temperature. Hydrobiologia, 575(1), 285-299.
Hessen, D. O. (2006). Determinants of seston C: P‐ratio in lakes. Freshwater Biology, 51(8), 1560-1569.

Michelutti, N., Wolfe, A. P., Vinebrooke, R. D., Rivard, B., & Briner, J. P. (2005). Recent primary production increases in arctic lakes. Geophysical Research Letters, 32(19).

O’Brien, W. J., Bahr, M., Hershey, A. E., Hobbie, J. E., Kipphut, G. W., Kling, G. W., ... & Vestal, J. R. (1997). The limnology of Toolik lake. In Freshwaters of Alaska (pp. 61-106). Springer, New York, NY.

